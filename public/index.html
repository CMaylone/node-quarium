<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title>R-Pi Aquarium Monitor</title>
  <!--Bootstrap-->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
</head>
<body>

<nav class="navbar navbar-default" role="navigation">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">Aquarium Monitor</a>
    </div>
  </div>
</nav>

<!--High Charts Graph Container-->
<div id="container">
</div>

<!--JQuery-->
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<!--Bootstrap-->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

<!--High Charts-->
<script src="http://code.highcharts.com/highcharts.js"></script>

<script>
  $(function () {
    $(document).ready(function () {
      Highcharts.setOptions({
        global: {
          useUTC: false
        }
      });

      $('#container').highcharts({
        chart: {
          type: 'spline',
          animation: Highcharts.svg, // don't animate in old IE
          marginRight: 10,
          events: {
            load: function () {

              // set up the updating of the chart each second
              var series = this.series[0];
              setInterval(function () {
                $.ajax({
                  url: '/api/temperature',
                  type: 'GET',
                  success: function(data) {
                    var x = (new Date()).getTime(), // current time
                        y = data.fahrenheit;
                    series.addPoint([x, y], true, true);
                  }
                });
              }, 5000);
            }
          }
        },
        title: {
          text: 'Live Aquarium Temperature (F\xB0)'
        },
        xAxis: {
          type: 'datetime',
          tickPixelInterval: 150
        },
        yAxis: {
          title: {
            text: 'Value'
          },
          plotLines: [{
            value: 0,
            width: 1,
            color: '#808080'
          }]
        },
        tooltip: {
          formatter: function () {
            return '<b>' + this.series.name + '</b><br/>' +
                Highcharts.dateFormat('%Y-%m-%d %H:%M:%S', this.x) + '<br/>' +
                Highcharts.numberFormat(this.y, 2) + ' F\xB0';
          }
        },
        legend: {
          enabled: false
        },
        exporting: {
          enabled: false
        },
        series: [{
          name: 'Temperature data'
        }]
      });
    });
  });
</script>
</body>
</html>